<html>
<head>
    <title>Conversion</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script src="http://cdn.jsdelivr.net/sockjs/0.3/sockjs.min.js"></script>
    <script>
         var conn = new SockJS('http://' + window.location.host + ':8084/ws');
         conn.onmessage = function(e){
             if (e.type === 'message' && e.data==="done"){
                 $('#notReady').text("READY! Grab your file!");
             }
             console.log(e);
         };
        conn.onopen = function(e){
           console.log("OPENED");
            conn.send($('#token').text())
         }
    </script>
</head>
<body>
    <h2>Conversion in progress</h2>
    <div id="notReady">
        Your token is <span id="token">{{ token }}</span>
        We will notify you on this page when conversion ends, or you can visit {{file_url}}
    </div>
    <div><a href={{file_url}}>Your file page</a></div>
</body>
</html>